"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53],{7053:function(e,s,a){var r=a(7437),t=a(2265),n=a(9376),i=a(243),o=a(6865),l=a(2369),u=a(9345),c=a(6337),d=a(7769),m=a(2208),h=a(6540);s.default=()=>{let e=(0,n.useRouter)(),{signup:s}=(0,i.a)(),[a,p]=(0,t.useState)(""),[g,f]=(0,t.useState)(""),[w,j]=(0,t.useState)(""),[x,y]=(0,t.useState)(""),[b,v]=(0,t.useState)(!1),[S,N]=(0,t.useState)(!1),[k,C]=(0,t.useState)(""),[T,A]=(0,t.useState)(!1),P=()=>a&&g&&w&&x?a.length<2?(C("Name must be at least 2 characters long."),!1):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(g)?w.length<8?(C("Password must be at least 8 characters long."),!1):w===x||(C("Passwords do not match."),!1):(C("Please enter a valid email address."),!1):(C("Please fill in all fields."),!1),I=async r=>{if(r.preventDefault(),C(""),P()){A(!0);try{let r=await s(a,g,w);r?C(r):e.push("/")}catch(e){C("An unexpected error occurred during signup. Please try again.")}finally{A(!1)}}};return(0,r.jsxs)("div",{className:"luno-login-container",children:[(0,r.jsx)("h1",{className:"luno-logo",children:"Luno"}),(0,r.jsx)("h2",{children:"Create Your Account"}),k&&(0,r.jsxs)("div",{className:"form-error fade-in-out",children:[(0,r.jsx)(o.Z,{className:"icon-alert",size:18}),(0,r.jsx)("strong",{children:"Error:"})," ",k]}),(0,r.jsxs)("form",{onSubmit:I,className:"login-form ".concat(T?"form-loading-animation":""),children:[(0,r.jsxs)("div",{className:"input-group",children:[(0,r.jsxs)("label",{htmlFor:"name",children:[(0,r.jsx)(l.Z,{className:"inline w-4 h-4 mr-1"}),"Full Name"]}),(0,r.jsx)("input",{id:"name",type:"text",value:a,onChange:e=>p(e.target.value),placeholder:"Enter your full name",required:!0,disabled:T})]}),(0,r.jsxs)("div",{className:"input-group",children:[(0,r.jsxs)("label",{htmlFor:"email",children:[(0,r.jsx)(u.Z,{className:"inline w-4 h-4 mr-1"}),"Email Address"]}),(0,r.jsx)("input",{id:"email",type:"email",value:g,onChange:e=>f(e.target.value),placeholder:"e.g., satoshi@luno.io",required:!0,disabled:T})]}),(0,r.jsxs)("div",{className:"input-group",children:[(0,r.jsxs)("label",{htmlFor:"password",children:[(0,r.jsx)(c.Z,{className:"inline w-4 h-4 mr-1"}),"Password"]}),(0,r.jsxs)("div",{className:"password-input-wrapper",children:[(0,r.jsx)("input",{id:"password",type:b?"text":"password",value:w,onChange:e=>j(e.target.value),placeholder:"Min 8 characters",required:!0,disabled:T}),(0,r.jsx)("button",{type:"button",className:"password-toggle-button",onClick:()=>v(!b),disabled:T,"aria-label":b?"Hide password":"Show password",children:b?(0,r.jsx)(d.Z,{size:18}):(0,r.jsx)(m.Z,{size:18})})]})]}),(0,r.jsxs)("div",{className:"input-group",children:[(0,r.jsxs)("label",{htmlFor:"confirmPassword",children:[(0,r.jsx)(c.Z,{className:"inline w-4 h-4 mr-1"}),"Confirm Password"]}),(0,r.jsxs)("div",{className:"password-input-wrapper",children:[(0,r.jsx)("input",{id:"confirmPassword",type:S?"text":"password",value:x,onChange:e=>y(e.target.value),placeholder:"Re-enter your password",required:!0,disabled:T}),(0,r.jsx)("button",{type:"button",className:"password-toggle-button",onClick:()=>N(!S),disabled:T,"aria-label":S?"Hide password":"Show password",children:S?(0,r.jsx)(d.Z,{size:18}):(0,r.jsx)(m.Z,{size:18})})]})]}),(0,r.jsx)("button",{type:"submit",className:"login-button ".concat(T?"button-busy":"button-ready"),disabled:T,children:T?(0,r.jsxs)("div",{className:"loading-content",children:[(0,r.jsx)(h.Z,{className:"loading-spinner",size:20}),(0,r.jsx)("span",{children:"Creating Account..."})]}):"Create Your Account"}),(0,r.jsx)("p",{className:"security-note",children:"By creating an account, you agree to our Terms of Service and Privacy Policy. We use industry-leading encryption to protect your data."})]}),(0,r.jsx)("div",{className:"signup-prompt",children:(0,r.jsxs)("p",{children:["Already have an account? ",(0,r.jsx)("a",{href:"/login",children:"Log In Now"})]})})]})}},243:function(e,s,a){a.d(s,{H:function(){return m},a:function(){return h}});var r=a(7437),t=a(2265),n=a(3301),i=a(738);a(5978);var o=a(62);let l=()=>{let e="AIzaSyB6VZGyh3S4IkOv1Wz81F1jd7oa-OlC1i0",s="luno-0.firebaseapp.com",a="luno-0";return e&&s&&a?{apiKey:e,authDomain:s,projectId:a,storageBucket:"luno-0.appspot.com",messagingSenderId:"368484485180",appId:"1:368484485180:web:3bd9361d2e566e4e045b39",measurementId:"G-1CVFF4B26Z"}:(console.error("CRITICAL: Firebase configuration is missing or incomplete in .env.local"),null)};function u(){if(0!==(0,i.C6)().length)return(0,i.Mq)();{let e=l();if(!e)throw Error("Firebase initialization failed due to missing configuration.");return(0,i.ZF)(e)}}let c=()=>{let e=u();return(0,n.v0)(e)};(()=>{let e=u();return(0,o.cF)(e)})();let d=(0,t.createContext)(void 0);function m(e){let{children:s}=e,[a,i]=(0,t.useState)(null),[o,l]=(0,t.useState)(null),[u,m]=(0,t.useState)(!0),h=c(),p=async e=>{if(!e.ok)return(await e.json()).error||"Authentication failed. Please try again.";let s=await e.json();return s.user&&s.user.id?(i({id:s.user.id,email:s.user.email,username:s.user.username,role:s.user.role||"trader",roles:s.user.roles||["trader"],migrationStatus:s.user.migrationStatus||"migrated",isAdmin:"admin"===s.user.role,accessToken:s.accessToken}),l(s.accessToken),localStorage.setItem("accessToken",s.accessToken),null):(console.error("Invalid auth response structure:",s),"Login successful, but the user object in the response was missing or malformed.")},g=async(e,s)=>{try{let a=await (0,n.e5)(h,e,s),r=await a.user.getIdToken(),t=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:r})});return await p(t)}catch(e){if(console.error("Login Error:",e),"auth/user-not-found"===e.code||"auth/wrong-password"===e.code||"auth/invalid-credential"===e.code)return"Invalid email or password.";return"Login failed. An unexpected error occurred."}},f=async(e,s,a)=>{try{let r=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:s,password:a})});if(!r.ok)return(await r.json()).error||"Signup failed. Please try again.";return await g(s,a)}catch(e){return console.error("Signup Error:",e),"Signup failed. An unexpected error occurred."}},w=()=>{h.signOut(),i(null),l(null),localStorage.removeItem("accessToken")};return(0,t.useEffect)(()=>{let e=(0,n.Aj)(h,async e=>{if(e)try{let s=await e.getIdToken(!0),a=await fetch("/api/auth/session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)}});if(a.ok){let e=await a.json(),s={id:e.user.id,email:e.user.email,username:e.user.username,role:e.user.role||"trader",roles:e.user.roles||["trader"],migrationStatus:e.user.migrationStatus||"migrated",isAdmin:"admin"===e.user.role,accessToken:e.accessToken};i(s),l(e.accessToken),localStorage.setItem("accessToken",e.accessToken)}else w()}catch(e){console.error("Session refresh error:",e),w()}else i(null),l(null);m(!1)});return()=>e()},[h]),(0,r.jsx)(d.Provider,{value:{user:a,isAuthenticated:!!a,accessToken:o,login:g,signup:f,logout:w,isLoading:u},children:s})}function h(){let e=(0,t.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);