(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{866:function(e,t,r){Promise.resolve().then(r.t.bind(r,4982,23)),Promise.resolve().then(r.t.bind(r,2778,23)),Promise.resolve().then(r.bind(r,543))},4766:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]])},1671:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(9205).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},543:function(e,t,r){"use strict";r.d(t,{default:function(){return k},l:function(){return g},F:function(){return f}});var n=r(7437),o=r(2265),i=r(1671),a=r(6865),s=r(4766);let l=["UNSAFE_componentWillMount","UNSAFE_componentWillReceiveProps","findDOMNode is deprecated"];{let e=console.error,t=console.warn,r=e=>{for(let t of e)if("string"==typeof t){for(let e of l)if(t.includes(e))return!0}return!1};console.warn=function(){for(var e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];r(n)||t.apply(console,n)},console.error=function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];r(n)||e.apply(console,n)}}var c=r(243),u=r(5201);let d=(0,o.createContext)(void 0),f=()=>{let e=(0,o.useContext)(d);if(!e)throw Error("useTheme must be used within a ThemeProvider");return e},h=e=>{let{children:t}=e,[r,i]=(0,o.useState)("light"),a=()=>{i(e=>{let t="light"===e?"dark":"light";return document.documentElement.classList.toggle("dark","dark"===t),t})};o.useEffect(()=>{{let e=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";i(e),document.documentElement.classList.toggle("dark","dark"===e)}},[]);let s=(0,o.useMemo)(()=>({theme:r,toggleTheme:a}),[r]);return(0,n.jsx)(d.Provider,{value:s,children:t})},m=(0,o.createContext)(void 0),g=()=>{let e=(0,o.useContext)(m);if(!e)throw Error("useNotification must be used within a NotificationProvider");return e},p=e=>{let{children:t}=e,[r,i]=(0,o.useState)([]),a=(e,t)=>{let r=Date.now(),n={id:r,message:e,type:t};i(e=>[...e,n]),setTimeout(()=>s(r),5e3)},s=e=>{i(t=>t.filter(t=>t.id!==e))},l=(0,o.useMemo)(()=>({notifications:r,addNotification:a,removeNotification:s}),[r]);return(0,n.jsxs)(m.Provider,{value:l,children:[t,(0,n.jsx)(y,{notifications:r,removeNotification:s})]})},y=e=>{let{notifications:t,removeNotification:r}=e;return(0,n.jsx)("div",{className:"fixed space-y-3 bottom-4 right-4 z-100",children:t.map(e=>{let t,l,c;switch(e.type){case"success":t=i.Z,l="bg-green-600",c="text-white";break;case"error":t=a.Z,l="bg-red-600",c="text-white";break;case"warning":t=a.Z,l="bg-yellow-500",c="text-gray-900";break;default:t=s.Z,l="bg-indigo-600",c="text-white"}return(0,n.jsxs)("div",{className:"p-4 rounded-lg shadow-xl flex items-center space-x-3 transition-opacity duration-300 animate-in fade-in slide-in-from-right ".concat(l," ").concat(c),role:"alert",children:[o.createElement(t,{className:"w-5 h-5 flex-shrink-0"}),(0,n.jsx)("span",{className:"text-sm font-medium",children:e.message}),(0,n.jsx)("button",{onClick:()=>r(e.id),className:"ml-4 opacity-70 hover:opacity-100 ".concat(c),children:"\xd7"})]},e.id)})})};function k(e){let{children:t}=e;return(0,n.jsx)(h,{children:(0,n.jsx)(c.H,{children:(0,n.jsx)(u.T,{children:(0,n.jsx)(p,{children:(0,n.jsx)("div",{className:"min-h-screen transition-colors duration-300 bg-gray-50 dark:bg-gray-900",children:t})})})})})}},243:function(e,t,r){"use strict";r.d(t,{H:function(){return f},a:function(){return h}});var n=r(7437),o=r(2265),i=r(3301),a=r(738);r(5978);var s=r(62);let l=()=>{let e="AIzaSyB6VZGyh3S4IkOv1Wz81F1jd7oa-OlC1i0",t="luno-0.firebaseapp.com",r="luno-0";return e&&t&&r?{apiKey:e,authDomain:t,projectId:r,storageBucket:"luno-0.appspot.com",messagingSenderId:"368484485180",appId:"1:368484485180:web:3bd9361d2e566e4e045b39",measurementId:"G-1CVFF4B26Z"}:(console.error("CRITICAL: Firebase configuration is missing or incomplete in .env.local"),null)};function c(){if(0!==(0,a.C6)().length)return(0,a.Mq)();{let e=l();if(!e)throw Error("Firebase initialization failed due to missing configuration.");return(0,a.ZF)(e)}}let u=()=>{let e=c();return(0,i.v0)(e)};(()=>{let e=c();return(0,s.cF)(e)})();let d=(0,o.createContext)(void 0);function f(e){let{children:t}=e,[r,a]=(0,o.useState)(null),[s,l]=(0,o.useState)(null),[c,f]=(0,o.useState)(!0),h=u(),m=async e=>{if(!e.ok)return(await e.json()).error||"Authentication failed. Please try again.";let t=await e.json();return t.user&&t.user.id?(a({id:t.user.id,email:t.user.email,username:t.user.username,role:t.user.role||"trader",roles:t.user.roles||["trader"],migrationStatus:t.user.migrationStatus||"migrated",isAdmin:"admin"===t.user.role,accessToken:t.accessToken}),l(t.accessToken),localStorage.setItem("accessToken",t.accessToken),null):(console.error("Invalid auth response structure:",t),"Login successful, but the user object in the response was missing or malformed.")},g=async(e,t)=>{try{let r=await (0,i.e5)(h,e,t),n=await r.user.getIdToken(),o=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:n})});return await m(o)}catch(e){if(console.error("Login Error:",e),"auth/user-not-found"===e.code||"auth/wrong-password"===e.code||"auth/invalid-credential"===e.code)return"Invalid email or password.";return"Login failed. An unexpected error occurred."}},p=async(e,t,r)=>{try{let n=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:r})});if(!n.ok)return(await n.json()).error||"Signup failed. Please try again.";return await g(t,r)}catch(e){return console.error("Signup Error:",e),"Signup failed. An unexpected error occurred."}},y=()=>{h.signOut(),a(null),l(null),localStorage.removeItem("accessToken")};return(0,o.useEffect)(()=>{let e=(0,i.Aj)(h,async e=>{if(e)try{let t=await e.getIdToken(!0),r=await fetch("/api/auth/session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(r.ok){let e=await r.json(),t={id:e.user.id,email:e.user.email,username:e.user.username,role:e.user.role||"trader",roles:e.user.roles||["trader"],migrationStatus:e.user.migrationStatus||"migrated",isAdmin:"admin"===e.user.role,accessToken:e.accessToken};a(t),l(e.accessToken),localStorage.setItem("accessToken",e.accessToken)}else y()}catch(e){console.error("Session refresh error:",e),y()}else a(null),l(null);f(!1)});return()=>e()},[h]),(0,n.jsx)(d.Provider,{value:{user:r,isAuthenticated:!!r,accessToken:s,login:g,signup:p,logout:y,isLoading:c},children:t})}function h(){let e=(0,o.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5201:function(e,t,r){"use strict";r.d(t,{T:function(){return s},x:function(){return l}});var n=r(7437),o=r(2265),i=r(243);let a=(0,o.createContext)(void 0);function s(e){let{children:t}=e,{user:r,isAuthenticated:s,accessToken:l}=(0,i.a)(),[c,u]=(0,o.useState)("Not Verified"),[d,f]=(0,o.useState)(!0),h=async()=>{if(!s||!r){u("Not Verified"),f(!1);return}f(!0);try{let e={};l&&(e.Authorization="Bearer ".concat(l));let t=await fetch("/api/kyc/status",{headers:e});if(t.ok){let e=await t.json();u(e.status||"Not Verified")}else u("Not Verified")}catch(e){console.error("Error fetching KYC status:",e),u("Not Verified")}finally{f(!1)}};return(0,o.useEffect)(()=>{h()},[s,r]),(0,n.jsx)(a.Provider,{value:{kycStatus:c,checkKycStatus:h,isLoading:d},children:t})}function l(){let e=(0,o.useContext)(a);if(void 0===e)throw Error("useKyc must be used within a KycProvider");return e}},2778:function(){},4982:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3",variable:"__variable_f367f3"}}},function(e){e.O(0,[578,358,139,256,971,117,744],function(){return e(e.s=866)}),_N_E=e.O()}]);